---
title: "treedensity-height_hurdle"
author: "anne"
date: "3 mai 2019"
output: word_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```



#### Modelling spatial autocorrelation (https://onlinelibrary.wiley.com/doi/full/10.1111/j.2007.0906-7590.05171.x)
Change the projection and make coordinates and a spatial point data frame to make a shapefile

```{r}
library(tidyr)
browse9.5m$UTMmerge <- paste(browse9.5m$UTM_OV_33, browse9.5m$UTM_SN_33, sep="_")
sum(duplicated(browse9.5m$UTMmerge))
```


```{r}

library(sp)
library(rgdal)

crs <- CRS("+proj=utm +zone=33 +ellps=GRS80 +units=m +no_defs")
coords <- cbind(browse9.5m$UTM_OV_33, browse9.5m$UTM_SN_33)
data_spdf <- SpatialPointsDataFrame(coords, browse9.5m, proj4string = crs)
# plot(data_spdf)
writeOGR(data_spdf, dsn = "output", layer = "spac", driver = "ESRI Shapefile")

```


```{r}

library(spdep)
library(ape)

# spdep package:

# prepare neighbour lists for spatial autocorrelation analysis
# nb.list <- dnearneigh(as.matrix(browse9.3[browse9.3$browspres_merged, c("UTM_OV_33", "UTM_SN_33")]), 0, 5000)
# nb.weights <- nb2listw(nb.list, zero.policy = TRUE)
# 
# moran.plot(resid_m1abin, nb.weights, zero.policy = TRUE, spChk = NULL, labels = TRUE, xlab = NULL, ylab = NULL, quiet = NULL)
# 
# resid_m1abin <- resid(m1abin, type = "pearson")
# resid_m1bbin <- resid(m1bbin, type = "pearson")
# 
# moran.test(browse9.3$browspres_merged, nb.weights, zero.policy = TRUE, randomisation=TRUE,
#  alternative="greater", rank = FALSE, na.action=na.fail, spChk=NULL,
#  adjust.n=TRUE, drop.EI2=FALSE)
# 
# moran.test(resid_m1bbin, nb.weights, zero.policy = TRUE, randomisation=TRUE,
#  alternative="greater", rank = FALSE, na.action=na.fail, spChk=NULL,
#  adjust.n=TRUE, drop.EI2=FALSE)


# Make a matrix of coordinates - use when chunk above was not run
coords <- as.matrix(cbind(browse9.5m$UTM_OV_33, browse9.5m$UTM_SN_33))

# compute the autocovariate based on the above distance and weight
ac <- autocov_dist(browse9.5m$browspres_merged, coords, nbs = 5000, type="inverse", zero.policy = TRUE)
browse9.5m$ac <- ac


save(browse9.5m, file = "browse9.5m.rda")


```




#### gam

```{r}
library(ggplot2)
ggplot(browse9.6, aes(x = disthus, y = browspres_merged)) +
    geom_point() +
    stat_smooth(method = "glm", color = "green") +
  stat_smooth(color = "blue")

# +
#   scale_x_continuous(breaks=c(100,150, 200, 250, 300, 400, 500, 1000, 1500, 2000, 3000))

```

```{r}
library(mgcv)



gam1 <- gam(proplt ~ disthus + distvei2 + skogkategori + treartgruppe9 + kant + helling + HOH + browspres_merged,
             data = browse9.6,
             method = "REML")

gam2 <- gam(proplt ~ s(disthus) + s(distvei2) + skogkategori + treartgruppe9 + kant + helling + HOH + browspres_merged,
             data = browse9.5m,
             method = "REML")

```

```{r}
plot.gam(gam1, all.terms = TRUE)
plot.gam(gam2, all.terms = TRUE)
# threshold: disthus ~700/900m, distvei2 ~200/300m
```









## Bin - First part of a hurdle model to account for zero inflation
##### Checking for the cut for disthus (browse9.5m/6) and best bin-house-model
```{r}
# load("processdata/browse9.5sc.rda")
load("processdata/browse9.5m.rda")
load("processdata/browse9.5msc.rda")
```

           "distvei2",
```{r}
library(lme4)

pvars <- c("disthus_400", "HOH", "ac", "disthus_500", "disthus_300", "disthus") # "disthus","disthus_500", "disthus_1000", "disthus_900", "disthus_800", "disthus_700", "disthus_600", "disthus_160", "disthus_300", "disthus_200", "disthus_175", "disthus_350", "helling", "browspres_merged"
browse9.5msc <- browse9.5m
browse9.5msc[pvars] <- lapply(browse9.5msc[pvars],scale)

save(browse9.5msc, file = "browse9.5msc.rda")


m1bin <- glmer(factor(proplt > 0) ~ disthus + distvei2 + skogkategori + treartgruppe9 + browspres_merged + kant + helling + HOH + I(HOH^2) +  ac + (1|KOMNR),
family = binomial(),
data = browse9.5msc)

m2bin <- glmer(factor(proplt > 0) ~ disthus_1000 + distvei2 + skogkategori + treartgruppe9 + browspres_merged + kant + helling + HOH + I(HOH^2) +  ac + (1|KOMNR),
family = binomial(),
data = browse9.5msc)

m3bin <- glmer(factor(proplt > 0) ~ disthus_900 + distvei2 + skogkategori + treartgruppe9 + browspres_merged + kant + helling + HOH + I(HOH^2) +  ac + (1|KOMNR),
family = binomial(),
data = browse9.5msc)

m4bin <- glmer(factor(proplt > 0) ~ disthus_800 + distvei2 + skogkategori + treartgruppe9 + browspres_merged + kant + helling + HOH + I(HOH^2) +  ac + (1|KOMNR),
family = binomial(),
data = browse9.5msc)

m5bin <- glmer(factor(proplt > 0) ~ disthus_700 + distvei2 + skogkategori + treartgruppe9 + browspres_merged + kant + helling + HOH + I(HOH^2) +  ac + (1|KOMNR),
family = binomial(),
data = browse9.5msc)

m6bin <- glmer(factor(proplt > 0) ~ disthus_600 + distvei2 + skogkategori + treartgruppe9 + browspres_merged + kant + helling + HOH + I(HOH^2) +  ac + (1|KOMNR),
family = binomial(),
data = browse9.5msc)

m7bin <- glmer(factor(proplt > 0) ~ disthus_500 + distvei2 + skogkategori + treartgruppe9 + browspres_merged + kant + helling + HOH + I(HOH^2) +  ac + (1|KOMNR),
family = binomial(),
data = browse9.5msc)

m8bin <- glmer(factor(proplt > 0) ~ disthus_400 + distvei2 + skogkategori + treartgruppe9 + browspres_merged + kant + helling + HOH + I(HOH^2) +  ac + (1|KOMNR),
family = binomial(),
data = browse9.5msc) # best!

m9bin <- glmer(factor(proplt > 0) ~ disthus_160 + distvei2 + skogkategori + treartgruppe9 + browspres_merged + kant + helling + HOH + I(HOH^2) +  ac + (1|KOMNR),
family = binomial(),
data = browse9.5msc)

m10bin <- glmer(factor(proplt > 0) ~ disthus_300 + distvei2 + skogkategori + treartgruppe9 + browspres_merged + kant + helling + HOH + I(HOH^2) +  ac + (1|KOMNR),
family = binomial(),
data = browse9.5msc) 

m11bin <- glmer(factor(proplt > 0) ~ disthus_200 + distvei2 + skogkategori + treartgruppe9 + browspres_merged + kant + helling + HOH + I(HOH^2) +  ac + (1|KOMNR),
family = binomial(),
data = browse9.5msc)

m12bin <- glmer(factor(proplt > 0) ~ disthus_175 + distvei2 + skogkategori + treartgruppe9 + browspres_merged + kant + helling + HOH + I(HOH^2) +  ac + (1|KOMNR),
family = binomial(),
data = browse9.5msc)

m13bin <- glmer(factor(proplt > 0) ~ disthus_350 + distvei2 + skogkategori + treartgruppe9 + browspres_merged + kant + helling + HOH + I(HOH^2) +  ac + (1|KOMNR),
family = binomial(),
data = browse9.5msc)

# ------------ log selection -----------

pvars <- c("disthus_400",
           "helling","HOH", "browspres_merged", "ac")
browse9.5msc <- browse9.5m
browse9.5msc[pvars] <- lapply(browse9.5msc[pvars],scale)

# "disthus_400", "disthus", "distvei2",

m0abin <- glmer(factor(proplt > 0) ~ log(disthus+1) + log(distvei2+1) + skogkategori + treartgruppe9 + browspres_merged + kant + helling + HOH + I(HOH^2) +  ac +  (1|KOMNR),
            family = binomial(),
            data = browse9.5msc)

m0bbin <- glmer(factor(proplt > 0) ~ log(disthus+1) + distvei2 + skogkategori + treartgruppe9 + browspres_merged + kant + helling + HOH + I(HOH^2) +  ac +  (1|KOMNR),
            family = binomial(),
            data = browse9.5msc)

m0cbin <- glmer(factor(proplt > 0) ~ disthus + log(distvei2+1) + skogkategori + treartgruppe9 + browspres_merged + kant + helling + HOH + I(HOH^2) +  ac +  (1|KOMNR),
            family = binomial(),
            data = browse9.5msc)

m0dbin <- glmer(factor(proplt > 0) ~ disthus_400 + log(distvei2+1) + skogkategori + treartgruppe9 + browspres_merged + kant + helling + HOH + I(HOH^2) +  ac + (1|KOMNR),
family = binomial(),
data = browse9.5msc) # BEST


```


```{r}

AIC(m1bin, m2bin, m3bin, m4bin, m5bin, m6bin, m7bin, m8bin, m9bin, m10bin, m11bin, m12bin, m13bin)

AIC(m0dbin, m8bin)

AIC(m7bin, m8bin, m10bin)

# cut 400 is the thing!


```

```{r}
library(sjPlot)

tab_model(m8bin, transform = NULL, 
          show.intercept = TRUE, show.est = TRUE, show.ci = 0.95, show.se = TRUE, show.std = NULL, show.p = TRUE, show.stat = FALSE, show.df = FALSE, show.zeroinf = FALSE, show.r2 = TRUE, show.icc = TRUE, show.adj.icc = FALSE, show.re.var = TRUE, show.aic = TRUE, show.dev = FALSE, show.obs = TRUE, p.threshold = c(0.05, 0.01, 0.001))

```


#### Model selection bin (browse9.5msc and browse9.6sc)
```{r}
library(lme4)
load("processdata/browse9.5msc.rda")

m8bin <- glmer(factor(proplt > 0) ~ disthus_400 + distvei2 + skogkategori + treartgruppe9 + browspres_merged + kant + helling + HOH + I(HOH^2) +  ac + (1|KOMNR),
family = binomial(),
data = browse9.5msc)

mhusbin <- glmer(factor(proplt > 0) ~ disthus_400 + log(distvei2+1) + skogkategori + treartgruppe9 + browspres_merged + kant + helling + HOH + I(HOH^2) +  ac + (1|KOMNR),
family = binomial(),
data = browse9.5msc) # best

mhusabin <- glmer(factor(proplt > 0) ~ disthus_400 + log(distvei2+1) + skogkategori + treartgruppe9 + browspres_merged + kant + helling + HOH + I(HOH^2) +  ac + (1|KOMNR),
family = binomial(),
data = browse9.5msc)

m8bbin <- glmer(factor(proplt > 0) ~ disthus_400 + log(distvei2+1) + skogkategori + treartgruppe9 + browspres_merged + helling + HOH + I(HOH^2) +  ac + (1|KOMNR),
family = binomial(),
data = browse9.5msc)

AIC(m8bin, m8abin, m8bbin)

save(mhusbin, file = "mhusbin.rda")
save(mhusabin, file = "mhusabin.rda")




load("processdata/browse9.6.rda")
load("processdata/browse9.6sc.rda")

pvars <- c("disthus_400","HOH","ac" ) #  "helling", "browspres_merged", "ac" 
browse9.6sc <- browse9.6
browse9.6sc[pvars] <- lapply(browse9.6sc[pvars],scale)

save(browse9.6sc, file = "browse9.6sc.rda")




m14bin <- glmer(factor(proplt > 0) ~ log(distvei2+1) + skogkategori + treartgruppe9 + browspres_merged + kant + helling + HOH + I(HOH^2) +  ac + (1|KOMNR),
family = binomial(),
data = browse9.6sc) # 2nd best with one point difference

# m14abin <- glmer(factor(proplt > 0) ~ log(distvei2+1) + skogkategori + treartgruppe9 + browspres_merged + kant + helling + HOH + I(HOH^2) +  ac + (1|KOMNR),
# family = binomial(link = "cloglog"),
# data = browse9.6sc)

m15bin <- glmer(factor(proplt > 0) ~ log(distvei2+1) + treartgruppe9 + browspres_merged + kant + helling + HOH + I(HOH^2) +  ac + (1|KOMNR),
family = binomial(),
data = browse9.6sc)

m16abin <- glmer(factor(proplt > 0) ~ log(distvei2+1) + skogkategori + treartgruppe9 + browspres_merged + helling + HOH + I(HOH^2) +  ac + (1|KOMNR),
family = binomial(),
data = browse9.6sc) # BEST  # scaled

m16bbin <- glmer(factor(proplt > 0) ~ log(distvei2+1) + skogkategori + treartgruppe9 + browspres_merged + helling + HOH + I(HOH^2) +  ac + (1|KOMNR),
family = binomial(),
data = browse9.6sc) # unscaled

m16cbin <- glmer(factor(proplt > 0) ~ log(distvei2+1) + skogkategori + treartgruppe9 + browspres_merged + helling + HOH + I(HOH^2) +  ac + (1|KOMNR),
family = binomial(),
data = browse9.6sc) # just helling and browse_merged unscaled --> BEST? at least used in path

m17bin <- glmer(factor(proplt > 0) ~ log(distvei2+1) + treartgruppe9 + browspres_merged + helling + HOH + I(HOH^2) +  ac + (1|KOMNR),
family = binomial(),
data = browse9.6sc)

m18bin <- glmer(factor(proplt > 0) ~ log(distvei2+1) + skogkategori + treartgruppe9 + browspres_merged + helling + HOH + I(HOH^2) + (1|KOMNR),
family = binomial(),
data = browse9.6sc) 

m19bin <- glmer(factor(proplt > 0) ~ log(distvei2+1) + treartgruppe9 + browspres_merged + helling + HOH + (1|KOMNR),
family = binomial(),
data = browse9.6sc)

m20bin <- glmer(factor(proplt > 0) ~ log(distvei2+1) + treartgruppe9 + browspres_merged + helling + HOH + skogkategori + (1|KOMNR),
family = binomial(),
data = browse9.6sc)

m21bin <- glmer(factor(proplt > 0) ~ log(distvei2+1) + treartgruppe9 + browspres_merged + helling + HOH + kant + (1|KOMNR),
family = binomial(),
data = browse9.6sc)

```

```{r}
AIC(m14bin, m15bin, m16bin, m17bin, m18bin, m19bin, m20bin, m21bin)
AIC(m14bin, m15bin, m16abin, m17bin, m18bin)

summary(m16bin)

library(effects)
plot(allEffects(m16cbin))
plot(effect("skogkategori", m16bin))

save(m16bin, file = "m16bin.rda")

```

       df      AIC
m14bin  16 10903.32
m15bin  12 10926.30
m16abin 13 10902.94
m17bin   9 10923.98
m18bin  12 10909.90

```{r}
browse9.6sc <- browse9.6sc[,c(1,3,7,15:17,19:20,25:26,33,40)]
browse9.6sc <- browse9.6sc[,c(1:10,12)]
save(browse9.6sc, file = "browse9.6sc.rda")
```





## Beta - Second part of a hurdle model

##### Checking for the cut for disthus (browse9.5mpos) and best beta-house-model 
```{r}
library(glmmTMB)
# load("processdata/browse9.6pos.rda")

browse9.5mpos <- browse9.5m[browse9.5m$proplt > 0, ]
browse9.5mpos$proplt <- ifelse(browse9.5mpos$proplt == 1, 0.99, browse9.5mpos$proplt)

pvars <- c("disthus","disthus_500", "disthus_400", "disthus_1000", "disthus_900", "disthus_800", "disthus_700", "disthus_600", "disthus_160", "disthus_300", "disthus_200", "disthus_175", "disthus_350",
           "distvei2",
           "helling","HOH", "ac", "browspres_merged")
browse9.5mpossc <- browse9.5mpos
browse9.5mpossc[pvars] <- lapply(browse9.5mpossc[pvars],scale)

save(browse9.5mpossc, file = "browse9.5mpossc.rda")


m1beta <- glmmTMB(proplt ~ disthus_1000 + distvei2 + skogkategori + treartgruppe9 + ac + kant + helling + HOH + I(HOH^2) + browspres_merged + (1|KOMNR),
            data = browse9.5mpossc,
            family = beta_family())

m2beta <- glmmTMB(proplt ~ disthus_900 + distvei2 + skogkategori + treartgruppe9 + ac + kant + helling + HOH + I(HOH^2) + browspres_merged + (1|KOMNR),
            data = browse9.5mpossc,
            family = beta_family())

m3beta <- glmmTMB(proplt ~ disthus_800 + distvei2 + skogkategori + treartgruppe9 + ac + kant + helling + HOH + I(HOH^2) + browspres_merged + (1|KOMNR),
            data = browse9.5mpossc,
            family = beta_family())

m4beta <- glmmTMB(proplt ~ disthus_700 + distvei2 + skogkategori + treartgruppe9 + ac + kant + helling + HOH + I(HOH^2) + browspres_merged + (1|KOMNR),
            data = browse9.5mpossc,
            family = beta_family())

m5beta <- glmmTMB(proplt ~ disthus_600 + distvei2 + skogkategori + treartgruppe9 + ac + kant + helling + HOH + I(HOH^2) + browspres_merged + (1|KOMNR),
            data = browse9.5mpossc,
            family = beta_family())

m6beta <- glmmTMB(proplt ~ disthus_500 + distvei2 + skogkategori + treartgruppe9 + ac + kant + helling + HOH + I(HOH^2) + browspres_merged + (1|KOMNR),
            data = browse9.5mpossc,
            family = beta_family())

m7beta <- glmmTMB(proplt ~ disthus_400 + distvei2 + skogkategori + treartgruppe9 + ac + kant + helling + HOH + I(HOH^2) + browspres_merged + (1|KOMNR),
            data = browse9.5mpossc,
            family = beta_family())

m8beta <- glmmTMB(proplt ~ disthus_300 + distvei2 + skogkategori + treartgruppe9 + ac + kant + helling + HOH + I(HOH^2) + browspres_merged + (1|KOMNR),
            data = browse9.5mpossc,
            family = beta_family())

m10beta <- glmmTMB(proplt ~ disthus_200 + distvei2 + skogkategori + treartgruppe9 + ac + kant + helling + HOH + I(HOH^2) + browspres_merged + (1|KOMNR),
            data = browse9.5mpossc,
            family = beta_family()) # best

m11beta <- glmmTMB(proplt ~ disthus_160 + distvei2 + skogkategori + treartgruppe9 + ac + kant + helling + HOH + I(HOH^2) + browspres_merged + (1|KOMNR),
            data = browse9.5mpossc,
            family = beta_family())

m12beta <- glmmTMB(proplt ~ disthus + distvei2 + skogkategori + treartgruppe9 + ac + kant + helling + HOH + I(HOH^2) + browspres_merged + (1|KOMNR),
            data = browse9.5mpossc,
            family = beta_family())



# ------ log selection ------
pvars <- c("disthus_200",
           "helling","HOH", "ac", "browspres_merged")
browse9.5mpossc <- browse9.5mpos
browse9.5mpossc[pvars] <- lapply(browse9.5mpossc[pvars],scale)

# "disthus", "disthus_200","distvei2",

m0abeta <- glmmTMB(proplt ~ distvei2 + skogkategori + treartgruppe9 + ac + kant + helling + HOH + I(HOH^2) + browspres_merged + (1|KOMNR),
            data = browse9.5mpossc,
            family = beta_family()) 

m0bbeta <- glmmTMB(proplt ~ log(distvei2+1) + skogkategori + treartgruppe9 + ac + kant + helling + HOH + I(HOH^2) + browspres_merged + (1|KOMNR),
            data = browse9.5mpossc,
            family = beta_family()) # Best!

m0cbeta <- glmmTMB(proplt ~ disthus_200 + log(distvei2+1) + skogkategori + treartgruppe9 + ac + kant + helling + HOH + I(HOH^2) + browspres_merged + (1|KOMNR),
            data = browse9.5mpossc,
            family = beta_family()) 

m0dbeta <- glmmTMB(proplt ~ skogkategori + treartgruppe9 + ac + kant + helling + HOH + I(HOH^2) + browspres_merged + (1|KOMNR),
            data = browse9.5mpossc,
            family = beta_family()) 

```


```{r}
AIC(m6beta, m7beta, m8beta, m10beta, m11beta, m12beta)
# all are the same (also not significant) -> I suppose that means that disthus is not important?
AIC(m10beta, m0bbeta)
# m0bbeta best!


```

```{r}
library(sjPlot)

tab_model(m0bbeta, transform = NULL, 
          show.intercept = TRUE, show.est = TRUE, show.ci = 0.95, show.se = TRUE, show.std = NULL, show.p = TRUE, show.stat = FALSE, show.df = FALSE, show.zeroinf = FALSE, show.r2 = TRUE, show.icc = TRUE, show.adj.icc = FALSE, show.re.var = TRUE, show.aic = TRUE, show.dev = FALSE, show.obs = TRUE, p.threshold = c(0.05, 0.01, 0.001))
```



##### Model selection (browse9.5mpos)
```{r}
library(glmmTMB)
load("processdata/browse9.5m.rda")
load("processdata/browse9.5mpos.rda")
load("processdata/browse9.5mpossc.rda")

browse9.5mpos <- browse9.5m[browse9.5m$proplt > 0, ]
browse9.5mpos$proplt <- ifelse(browse9.5mpos$proplt == 1, 0.99, browse9.5mpos$proplt)
browse9.6sc$proplt <- ifelse(browse9.6sc$proplt == 1, 0.99, browse9.6sc$proplt)

pvars <- c("HOH", "ac") # "helling", "browspres_merged"
browse9.5mpossc <- browse9.5mpos
browse9.5mpossc[pvars] <- lapply(browse9.5mpossc[pvars],scale)

save(browse9.5mpossc, file = "browse9.5mpossc.rda")


m12beta <- glmmTMB(proplt ~ log(distvei2+1) + skogkategori + treartgruppe9 + ac + kant + helling + HOH + I(HOH^2) + browspres_merged + (1|KOMNR),
            data = browse9.5mpossc,
            family = beta_family())

m13beta <- glmmTMB(proplt ~ log(distvei2+1) + skogkategori + treartgruppe9 + ac + helling + HOH + I(HOH^2) + browspres_merged + (1|KOMNR),
            data = browse9.5mpossc,
            family = beta_family()) # 2nd best same AIC as Best, but doesn't converge and is not simplest

m14beta <- glmmTMB(proplt ~ log(distvei2+1) + skogkategori + treartgruppe9 + kant + helling + HOH + I(HOH^2) + browspres_merged + (1|KOMNR),
            data = browse9.5mpossc,
            family = beta_family())

m15beta <- glmmTMB(proplt ~ log(distvei2+1) + skogkategori + treartgruppe9 + helling + HOH + I(HOH^2) + browspres_merged + (1|KOMNR),
            data = browse9.5mpossc,
            family = beta_family()) # BEST

m16beta <- glmmTMB(proplt ~ log(distvei2+1) + skogkategori + treartgruppe9 + HOH + I(HOH^2) + browspres_merged + (1|KOMNR),
            data = browse9.5mpossc,
            family = beta_family()) # 3rd best and one less AIC than Best, and is simplest

m16abeta <- glmmTMB(proplt ~ log(distvei2+1) + skogkategori + treartgruppe9 + HOH + I(HOH^2) + browspres_merged + (1|KOMNR),
            data = browse9.5mpossc,
            family = beta_family()) 

m17beta <- glmmTMB(proplt ~ log(distvei2+1) + skogkategori + treartgruppe9 + kant + HOH + I(HOH^2) + browspres_merged + (1|KOMNR),
            data = browse9.5mpossc,
            family = beta_family())

m18beta <- glmmTMB(proplt ~ skogkategori + treartgruppe9 + HOH + I(HOH^2) + browspres_merged + (1|KOMNR),
            data = browse9.5mpossc,
            family = beta_family()) 

```

###### AIC selection
```{r}
summary(m16beta)
load("output/m16abeta.rda")

AIC(m12beta, m13beta, m14beta, m15beta, m16beta, m16abeta)

library(effects)
plot(allEffects(m16beta))
plot(effect("skogkategori", m16beta))

save(m16beta, file = "m16beta.rda")

```


```{r}
browse9.5mpossc <- browse9.5mpossc[,c(1,3,7,15:17,19:20,25:26,40)]
save(browse9.5mpossc, file = "browse9.5mpossc.rda")
```





## Tables

```{r}
load("output/m16abeta.rda")
```


Table of estimates:
```{r}
library(sjPlot)

tab_model(m16cbin, transform = NULL, 
          show.intercept = TRUE, show.est = TRUE, show.ci = 0.95, show.se = TRUE, show.std = NULL, show.p = TRUE, show.stat = FALSE, show.df = FALSE, show.zeroinf = FALSE, show.r2 = TRUE, show.icc = TRUE, show.adj.icc = FALSE, show.re.var = TRUE, show.aic = TRUE, show.dev = FALSE, show.obs = TRUE, p.threshold = c(0.05, 0.01, 0.001))


tab_model(m16abeta, transform = NULL, 
          show.intercept = TRUE, show.est = TRUE, show.ci = 0.95, show.se = TRUE, show.std = NULL, show.p = TRUE, show.stat = FALSE, show.df = FALSE, show.zeroinf = FALSE, show.r2 = TRUE, show.icc = TRUE, show.adj.icc = FALSE, show.re.var = TRUE, show.aic = TRUE, show.dev = FALSE, show.obs = TRUE, p.threshold = c(0.05, 0.01, 0.001))


```